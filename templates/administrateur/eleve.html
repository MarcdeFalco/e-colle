{% extends 'administrateur/action.html' %}
{% load static %}
{% load customfilter %}
{% block body %}
    <div class="ui text container">
        <h1 class="ui center aligned icon header">
            <i class="circular users icon"></i>
            Élèves
        </h1>
        <div class="ui three column center aligned grid">
                    <div class="middle aligned row">
                        <div class="column">
	<form method="post">
	{% csrf_token %}
	<table class="ui table">
	{{ form.as_table }}
	<tr><td colspan="2"><input class="ui button primary" type="submit" value="Envoyer" name = "selectclasse"/></td></tr>
	</table>
	</form>
        </div>
        <div class="column">
	<form method="post">
	{% csrf_token %}
	<table class="ui table">
        <thead>
	<tr><th colspan="2">Chercher un élève</th></tr>
        </thead>
        <tbody>
	{{ form3.as_table }}
	<tr><td colspan="2"><input class="ui button primary" type="submit" value="Chercher" name = "chercheuser"/></td></tr>
        </tbody>
	</table>
	</form>
        </div>
        <div class="column">
            <div class="ui vertical buttons">
	    <a class="ui button primary" href="{% url 'csv_eleve' %}">Importer des élèves depuis un fichier CSV</a>
		<a class="ui button primary" href="{% url 'ajout_eleve' %}">Ajouter des élèves</a>
            </div>
        </div>
                    </div>
        </div>

        <h2 class="ui header center">Liste des élèves ({{ form2.fields.eleve.queryset|length }})</h2>
    </div>
    <div class="ui container fluid">
	<form method="post">
	{% csrf_token %}
	<table class="tableausimple ui celled table" id="suppr">
        <thead>
		<tr>
			<th>Sélectionner{{form2.colleur.errors}}</th>
			<th>{% if tri == True %}<a href = "{% url 'gestion_eleve_tri' 0 %}" title="Trier les élèves par nom puis par classe" >Nom</a>{% else %}Nom{% endif %}</th>
			<th>Prénom</th>
			<th>Identifiant</th>
			<th>Email</th>
			<th>Date de naissance</th>
			<th>Lieu de naissance</th>
			<th>n° INE</th>
			<th>{% if tri == False %}<a href = "{% url 'gestion_eleve_tri' 1 %}" title="Trier les élèves par classe puis par nom" >Classe</a>{% else %}Classe{% endif %}</th>
			<th>LV1</th>
			<th>LV2</th>
			<th>Photo</th>
			<th>Modifier</th>
			<th>Supprimer</th>
			<th>RGPD</th>
		</tr>
        </thead>
        <tbody>
		{% for eleve,widget in form2.fields.eleve.queryset|tzip:form2.eleve %}
		<tr>
			<td>{{widget}}</td>
			<td>{{eleve.user.last_name|upper}}</td>
			<td>{{eleve.user.first_name|title}}</td>
			<td>{{eleve.user.username}}</td>
			<td>{{eleve.user.email}}</td>
			<td>{% if eleve.ddn %}{{eleve.ddn|date:'d/m/Y'}}{% endif %}</td>
			<td>{% if eleve.ldn %}{{eleve.ldn|title}}{% endif %}</td>
			<td>{% if eleve.ine %}{{eleve.ine}}{% endif %}</td>
			<td>{{eleve.classe.nom}}</td>
			<td>{% if eleve.lv1 %}{{eleve.lv1.nom|title}}{% endif %}</td>
			<td>{% if eleve.lv2 %}{{eleve.lv2.nom|title}}{% endif %}</td>
			<td>{% with eleve.photo as photo %}{% if photo %} <img alt="photo élève" class="photo" src="{{ photo.url }}"/>{% endif %} {% endwith %}</td>
			<td><a class="bouton" href="{% url 'modif_eleve' eleve.pk %}">Modifier</a></td>
			<td><a class="bouton" href="{% url 'suppr_eleve' eleve.pk %}">Supprimer</a></td>
			<td><a class="bouton" href="{% url 'rgpd_eleve' eleve.pk %}">RGPD</td>
		</tr>
		{% endfor %}
		<tr class="plusclair">
			<td><label for = "check">Tout cocher</label><br/><input type="checkbox" id="check"/></td>
			<td colspan="3"><input type="submit" value="Supprimer la sélection" name="supprimer"/></td>
			<td colspan="3"><input type="submit" value="Modifier la sélection" name="modifier"/></td>
			<td colspan="2"><input type="submit" value="Transférer la sélection en" name="transferer"/> {{ form2.klasse }}</td>
			<td colspan="3"><input type="submit" value="passer la sélection en lv1" name="lv1"/>{{form2.lv1}}</td>
			<td colspan="3"><input type="submit" value="passer la sélection en lv2" name="lv2"/>{{form2.lv2}}</td>
		</tr>
        </tbody>
	</table>
	</form>
    </div>
{% endblock %}
{% block javascript %}
<script type="text/javascript" src="{% static 'javascript/suppression.js' %}"></script>
<script type="text/javascript" src="{% static 'javascript/selection.js' %}"></script>
{% endblock %}
